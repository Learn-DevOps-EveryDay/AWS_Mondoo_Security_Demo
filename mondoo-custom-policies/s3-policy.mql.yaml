policies:
  - uid: aws-s3-security                        # A unique identifier for the policy
    name: AWS S3 Versioning Policy              # A descriptive name for the policy
    version: "1.0.1"                            # The current version of the policy.
    scoring_system: highest impact              # How Mondoo calculates the score for an asset: average or highest impact.
    authors:                                    # The person or entity to credit for writing the policy, and email where they can be reached.
      - name: Santosh Nagaraj
        email: san.n1597@gmail.com
    docs: 
      desc: | 
        Check whether S3 buckets have versioning enabled.
    groups:
      - title: groups1
        checks:                                # An MQL query that also makes an assertion and produces a score is called a check.
          - uid: s3-01  
            title: All S3 buckets must have versioning enabled
            mql: aws.s3.buckets.all( versioning.status == 'Enabled' )  # MQL assertion to check if versioning is enabled on all s3.
            impact: 60                        #How important (on a scale from 0 to 100) the check is in the scope of the entire policy. 

    queries:      # Optional, but useful for reusable checks | It can be referencd in multiple checks ($s3-version-1-query) 
      - uid: s3-version-1-query
        title: All S3 buckets must have versioning enable
        mql: aws.s3.buckets.all( versioning.status == 'Enabled' )